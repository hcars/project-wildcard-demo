{% extends 'base.html' %}
{% block content %}
<!-- Example single danger button -->
<div class="btn-group">
    <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Sort By
    </button>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="{% url 'tasks:sort_tasks' %}?sort_by=start_time">Start Time</a>
      <a class="dropdown-item" href="{% url 'tasks:sort_tasks' %}?sort_by=task_name">Task Name</a>
    </div>
</div>

<div class="container-md" >
    {% if task_list %}
    <ul class="list-group">
        {% for task in task_list %}
        <br class="list-group-item">
            {% if not task.completed %}
            <div class="form-check">
                <form action="{% url 'tasks:check_off' %}" method='post' id="check">
                    {% csrf_token %}
                    <input type="hidden" name="task_id" value='{{task.id}}'>
                    <input class="form-check-input" type="checkbox"
                           onclick="document.getElementById('check').submit();">
                </form>
                <label class="form-check-label badge badge-secondary">
                    Completed?
                </label>
                {% if task.link != "" %}
                <h5><a href="{{task.link}}"
                >{{ task.task_name }}</a></h5>
                {% else %}
                <h5>{{ task.task_name }}</h5>
                {% endif %}
            <p1 class="text-justify">{{ task.task_desc }}</p1>
            </br>
            Start time: {{ task.start_time }}</br>
            End time: {{ task.end_time }}
            </div>
            {% else %}
                <form action="{% url 'tasks:uncheck' %}" method='post' id="uncheck">
                {% csrf_token %}
                <input type="hidden" name="task_id" value='{{task.id}}'>
                <label onmouseover="undoButton(this)" id="{{task.id}}" onmouseout="normalButton(this)"
                       onclick="document.getElementById('uncheck').submit();"
                       class="form-check-label badge" style="color:green">
                    Completed!
                </label>
            </form>
                <script>
            function undoButton(button) {
                        document.getElementById(button.id).innerHTML = "Undo?";
                        document.getElementById(button.id).style = "color:red";
                    }
            function normalButton(button) {
                        document.getElementById(button.id).innerHTML = "Completed!";
                        document.getElementById(button.id).style = "color:green";
                    }
                </script>
                <form action="{% url 'tasks:delete_task' %}" method='post' id='delete'>
                    {% csrf_token %}
                    <input type="hidden" name="task_id" value="{{task.id}}">
                    <button class="btn btn-danger" onclick="document.getElementId('delete').submit();">Delete</button>
                </form>
            <strike>
            <h5>{{ task.task_name }}</h5>
            <p1 class="text-justify">{{ task.task_desc }}</p1>
            Start time: {{ task.start_time }}</br>
            End time: {{ task.end_time }} </br>
            </strike>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>You have no tasks!</p>
    {% endif %}
</div>
<a href="{% url 'tasks:add_task' %}"><button class="btn-primary" id="add_button">
    Add Task
</button></a>
{% endblock %}
